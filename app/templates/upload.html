<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload CSV</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    .spinner {
      border: 4px solid #e5e7eb;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      animation: spin 0.7s linear infinite;
      display: none;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>
<body class="bg-gray-100">

  <div class="max-w-lg mx-auto mt-20 p-8 bg-white shadow rounded-lg">
    <h1 class="text-2xl font-semibold text-gray-800 mb-6 text-center">
      Upload CSV Dataset
    </h1>

    <form id="uploadForm" action="/api/upload-csv-web" method="post" enctype="multipart/form-data"
      class="flex flex-col items-center gap-4">

      <input type="file" name="file" accept=".csv"
        class="border border-gray-300 rounded px-3 py-2 w-full cursor-pointer" required>

      <button id="uploadBtn" type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded shadow">
        Upload CSV
      </button>

      <div id="spinner" class="spinner"></div>

      {% if uploaded %}
      <p class="text-green-600 font-semibold text-center mt-4">
        {{ message }}
      </p>
      {% endif %}

    </form>

    <div class="mt-6 text-center">
      <a href="/rows" class="inline-block bg-gray-800 hover:bg-black text-white px-5 py-2 rounded shadow">
        View Data
      </a>
    </div>
  </div>

  <!-- JS for spinner + success message -->
  <script>
    const form = document.getElementById("uploadForm");
    const spinner = document.getElementById("spinner");
    const uploadBtn = document.getElementById("uploadBtn");
    const statusMessage = document.getElementById("statusMessage");

    form.addEventListener("submit", () => {
      spinner.style.display = "inline-block";
      uploadBtn.disabled = true;
      uploadBtn.classList.add("opacity-50", "cursor-not-allowed");
      statusMessage.textContent = "Uploading... Please wait.";
    });

    // Upload complete is shown when redirected back to /rows
  </script>

</body>
</html>